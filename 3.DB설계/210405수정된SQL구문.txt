USE STUDYINGP;
CREATE TABLE MEMBERTBL
(
    `MEM_CODE`    INT             NOT NULL    AUTO_INCREMENT COMMENT '회원번호', 
    `MEM_ID`      VARCHAR(45)     NULL        COMMENT '아이디', 
    `MEM_PW`      VARCHAR(200)    NULL        COMMENT '비밀번호', 
    `MEM_NAME`    VARCHAR(45)     NULL        COMMENT '이름', 
    `MEM_PHONE`   VARCHAR(45)     NULL        COMMENT '전화번호', 
    `MEM_EMAIL`   VARCHAR(100)    NULL        COMMENT '이메일', 
    `MEM_ACCESS`  TINYINT         NULL        COMMENT '권한', 
    `MEM_DATE`    DATE            NULL        COMMENT '가입일', 
    `MEM_STATUS`  TINYINT         NULL        COMMENT '탈퇴여부', 
    PRIMARY KEY (MEM_CODE)
);

ALTER TABLE MEMBERTBL COMMENT '회원 테이블';



CREATE TABLE CLASSTBL
(
    `CLS_CODE`      INT            NOT NULL    AUTO_INCREMENT COMMENT '강의코드', 
    `CLS_CATEGORY`  VARCHAR(45)    NULL        COMMENT '강의분류', 
    `CLS_NAME`      VARCHAR(45)    NULL        COMMENT '강의명', 
    `MEM_CODE`      INT            NULL        COMMENT '회원번호', 
    `CLS_PRICE`     INT            NULL        COMMENT '가격', 
    `CLS_TIME`      TIME           NULL        COMMENT '강의재생시간', 
    `CLS_DELETE`	TINYINT			NULL		COMMENT '강의삭제여부',
    `CLS_PERIOD`    DATE           NULL        COMMENT '강의기간',
    PRIMARY KEY (CLS_CODE)
);

ALTER TABLE CLASSTBL COMMENT '강의 테이블';

ALTER TABLE CLASSTBL
    ADD CONSTRAINT FK_CLASSTBL_MEM_CODE_MEMBERTBL_MEM_CODE FOREIGN KEY (MEM_CODE)
        REFERENCES MEMBERTBL (MEM_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;



CREATE TABLE ORDERTBL
(
    `ORD_CODE`    INT        NOT NULL    AUTO_INCREMENT COMMENT '주문번호', 
    `MEM_CODE`    INT        NULL        COMMENT '회원번호', 
    `CLS_CODE`    INT        NULL        COMMENT '강의코드', 
    `ORD_DATE`    DATE       NULL        COMMENT '주문날짜', 
    `ORD_TOTAL`   INT        NULL        COMMENT '주문금액', 
    `ORD_CANCEL`  TINYINT    NULL        COMMENT '주문취소여부', 
    `ORD_CHECK`  TINYINT    NULL        COMMENT '결제확인',
    `ORD_CHKDATE`  DATE   NULL        COMMENT '결제확인날짜',
    PRIMARY KEY (ORD_CODE)
);

ALTER TABLE ORDERTBL COMMENT '주문 테이블';

ALTER TABLE ORDERTBL
    ADD CONSTRAINT FK_ORDERTBL_MEM_CODE_MEMBERTBL_MEM_CODE FOREIGN KEY (MEM_CODE)
        REFERENCES MEMBERTBL (MEM_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE ORDERTBL
    ADD CONSTRAINT FK_ORDERTBL_CLS_CODE_CLASSTBL_CLS_CODE FOREIGN KEY (CLS_CODE)
        REFERENCES CLASSTBL (CLS_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;



CREATE TABLE BOARDTBL
(
    `BRD_CODE`       INT              NOT NULL    AUTO_INCREMENT COMMENT '글번호', 
    `BRD_TITLE`     VARCHAR(100)     NULL        COMMENT '글제목', 
    `BRD_HIT`       INT              NULL        COMMENT '조회수', 
    `BRD_DATE`      DATE             NULL        COMMENT '작성일', 
    `BRD_CONTENT`   VARCHAR(3000)    NULL        COMMENT '글내용', 
    `MEM_CODE`      INT              NULL        COMMENT '회원번호', 
    `CLS_CODE`      INT              NULL        COMMENT '강의코드', 
    `BRD_CATEGORY`  TINYINT          NULL        COMMENT '말머리', 
    `BRD_DELETE`    TINYINT          NULL        COMMENT '삭제여부', 
    `BRD_RATING`    TINYINT          NULL        COMMENT '강의평점', 
    PRIMARY KEY (BRD_CODE)
);

ALTER TABLE BOARDTBL COMMENT '게시판 테이블';

ALTER TABLE BOARDTBL
    ADD CONSTRAINT FK_BOARDTBL_MEM_CODE_MEMBERTBL_MEM_CODE FOREIGN KEY (MEM_CODE)
        REFERENCES MEMBERTBL (MEM_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE BOARDTBL
    ADD CONSTRAINT FK_BOARDTBL_CLS_CODE_CLASSTBL_CLS_CODE FOREIGN KEY (CLS_CODE)
        REFERENCES CLASSTBL (CLS_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;
        
        DROP table COMMENTTBL;
        
        
CREATE TABLE COMMENTTBL
(
    `CMT_CODE`       INT              NOT NULL    AUTO_INCREMENT COMMENT '댓글번호', 
    `BRD_CODE`      INT     NULL        COMMENT '게시글번호', 
    `MEM_CODE`       INT              NULL        COMMENT '회원번호', 
    `CMT_CONTENT`   VARCHAR(1000)    NULL        COMMENT '댓글내용', 
    `CMT_DATE`      DATE              NULL        COMMENT '회원번호', 
    PRIMARY KEY (CMT_CODE)
);        
ALTER TABLE COMMENTTBL COMMENT '댓글 테이블';

ALTER TABLE COMMENTTBL
    ADD CONSTRAINT FK_COMMENTTBL_MEM_CODE_MEMBERTBL_MEM_CODE FOREIGN KEY (MEM_CODE)
        REFERENCES MEMBERTBL (MEM_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE COMMENTTBL
    ADD CONSTRAINT FK_COMMENTTBL_BRD_CODE_BOARDTBL_BRD_CODE FOREIGN KEY (BRD_CODE)
        REFERENCES BOARDTBL (BRD_CODE) ON DELETE RESTRICT ON UPDATE RESTRICT;
        
        